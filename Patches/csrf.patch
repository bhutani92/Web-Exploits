diff -Naur bookstore/AdminBooks.jsp bookstore_secure/AdminBooks.jsp
--- bookstore/AdminBooks.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/AdminBooks.jsp	2018-03-03 20:57:42.822015793 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -348,4 +351,4 @@
   }
   catch (Exception e) { out.println(e.toString()); }
 }
-%>
\ No newline at end of file
+%>
diff -Naur bookstore/AdminMenu.jsp bookstore_secure/AdminMenu.jsp
--- bookstore/AdminMenu.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/AdminMenu.jsp	2018-03-03 20:57:42.850015857 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -93,4 +96,4 @@
     }
     catch (Exception e) { out.println(e.toString()); }
   }
-%>
\ No newline at end of file
+%>
diff -Naur bookstore/AdvSearch.jsp bookstore_secure/AdvSearch.jsp
--- bookstore/AdvSearch.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/AdvSearch.jsp	2018-03-03 20:57:41.738013332 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 boolean bDebug = false;
 
 String sAction = getParam( request, "FormAction");
@@ -118,4 +121,4 @@
     }
     catch (Exception e) { out.println(e.toString()); }
   }
-%>
\ No newline at end of file
+%>
diff -Naur bookstore/BookDetail.jsp bookstore_secure/BookDetail.jsp
--- bookstore/BookDetail.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/BookDetail.jsp	2018-03-03 20:57:41.726013304 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(1, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -804,4 +807,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
diff -Naur bookstore/BookMaint.jsp bookstore_secure/BookMaint.jsp
--- bookstore/BookMaint.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/BookMaint.jsp	2018-03-03 20:57:42.818015784 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -420,4 +423,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
diff -Naur bookstore/Books.jsp bookstore_secure/Books.jsp
--- bookstore/Books.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/Books.jsp	2018-03-03 20:57:41.882013662 -0600
@@ -9,6 +9,9 @@
 
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 boolean bDebug = false;
 
 String sAction = getParam( request, "FormAction");
diff -Naur bookstore/CardTypesGrid.jsp bookstore_secure/CardTypesGrid.jsp
--- bookstore/CardTypesGrid.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/CardTypesGrid.jsp	2018-03-03 20:57:42.850015857 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -192,4 +195,4 @@
   }
   catch (Exception e) { out.println(e.toString()); }
 }
-%>
\ No newline at end of file
+%>
diff -Naur bookstore/CardTypesRecord.jsp bookstore_secure/CardTypesRecord.jsp
--- bookstore/CardTypesRecord.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/CardTypesRecord.jsp	2018-03-03 20:57:41.730013313 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -293,4 +296,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
diff -Naur bookstore/CategoriesGrid.jsp bookstore_secure/CategoriesGrid.jsp
--- bookstore/CategoriesGrid.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/CategoriesGrid.jsp	2018-03-03 20:57:42.814015775 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -238,4 +241,4 @@
   }
   catch (Exception e) { out.println(e.toString()); }
 }
-%>
\ No newline at end of file
+%>
diff -Naur bookstore/CategoriesRecord.jsp bookstore_secure/CategoriesRecord.jsp
--- bookstore/CategoriesRecord.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/CategoriesRecord.jsp	2018-03-03 20:57:42.818015784 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -293,4 +296,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
diff -Naur bookstore/Common.jsp bookstore_secure/Common.jsp
--- bookstore/Common.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/Common.jsp	2018-03-03 20:57:42.850015857 -0600
@@ -23,6 +23,17 @@
   static final String DBusername="user";
   static final String DBpassword="abcd";
 
+  public static boolean checkRefererValid(javax.servlet.http.HttpServletRequest request) {
+    String referer = request.getHeader("referer");
+    if (referer != null && referer.matches(".*127.0.0.1.*")) {
+	return true;
+    }
+    if (referer != null && referer.matches(".*localhost.*")) {
+	return true;
+    }
+    return false;
+  }
+
   public static String loadDriver () {
     String sErr = "";
     try {
diff -Naur bookstore/EditorialCatGrid.jsp bookstore_secure/EditorialCatGrid.jsp
--- bookstore/EditorialCatGrid.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/EditorialCatGrid.jsp	2018-03-03 20:57:41.882013662 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -239,4 +242,4 @@
   }
   catch (Exception e) { out.println(e.toString()); }
 }
-%>
\ No newline at end of file
+%>
diff -Naur bookstore/EditorialCatRecord.jsp bookstore_secure/EditorialCatRecord.jsp
--- bookstore/EditorialCatRecord.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/EditorialCatRecord.jsp	2018-03-03 20:57:41.718013286 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -290,4 +293,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
diff -Naur bookstore/EditorialsGrid.jsp bookstore_secure/EditorialsGrid.jsp
--- bookstore/EditorialsGrid.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/EditorialsGrid.jsp	2018-03-03 20:57:42.826015802 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -254,4 +257,4 @@
   }
   catch (Exception e) { out.println(e.toString()); }
 }
-%>
\ No newline at end of file
+%>
diff -Naur bookstore/EditorialsRecord.jsp bookstore_secure/EditorialsRecord.jsp
--- bookstore/EditorialsRecord.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/EditorialsRecord.jsp	2018-03-03 20:57:41.718013286 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -340,4 +343,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
diff -Naur bookstore/.git/index bookstore_secure/.git/index
--- bookstore/.git/index	2018-03-03 20:58:34.613667112 -0600
+++ bookstore_secure/.git/index	2018-03-03 20:57:41.902013708 -0600
@@ -1,12 +1,14 @@
-DIRC      ?Z›`Ú! KØZ›`Ú! KØ    ça  í          ;I/3ûÓ€(p–`Bš¥m­ˆ5&u` AdminBooks.jsp    Z›`Ú! KØZ›`Ú! KØ    ¹   í          +p:ÀPlocbu§TYàqû AdminMenu.jsp     Z›`Ú! KØZ›`Ú! KØ    ¹!  í          `!'Èz¯†ˆÌƒEÑÌ í®ª® AdvSearch.jsp     Z›`Ú! KØZ›`Ú! KØ    ¹"  í          xtGg
-Bç†^¬¥¯_à‡ŞÖB• BookDetail.jsp    Z›`Ú! KØZ›`Ú! KØ    ¹#  í          CäS[ãJÄmòÎLÜFñ;ŸD-
-´2 BookMaint.jsp     Z›`Ú! KØZ›`Ú! KØ    ¹$  í          Mé<FCÇAB×ö¨Ñ]¦Ö}Ã¾Ò? 	Books.jsp Z›`Ú! KØZ›`Ú! KØ    ¹%  í          ‘šg¿ç6Dœ+’]“„| 9‰j CardTypesGrid.jsp Z›`Ú! KØZ›`Ú! KØ    ¹&  í          ($t2kşPßÇ¤¾µôZàòı¹Ëè“ CardTypesRecord.jsp       Z›`Ú! KØZ›`Ú! KØ    ¹'  í          "VÆw“°=«ƒ.q)¬ĞZ[ÈM CategoriesGrid.jsp        Z›`Ú! KØZ›`Ú! KØ    ¹(  í          (0î®ÕJ2 ƒ$û¿!Z4fjí‹À: CategoriesRecord.jsp      Z›`Ú! KØZ›`Ú! KØ    ¹;  í          +—K(4üüdŸ`7ªîÏÂªıv²ı¼ 
-Common.jsp        ZŒ ÓjúZŒ Ójú    ¹+  í          {Ñm WŸÚ&å·øë·	|÷‰}‚Q Default.jsp       Z›`Ú! KØZ›`Ú! KØ    ¹)  í          #ä«<vAn¹4 nãqÕ¢I~( EditorialCatGrid.jsp      Z›`Ú! KØZ›`Ú! KØ    ¹,  í          *ÂpmÒêMœÙ!µ2 AÂar¶d EditorialCatRecord.jsp    Z›`Ú! KØZ›`Ú! KØ    ¹-  í          )CºÔó	OùZRÌÑÅ3”K3§v: EditorialsGrid.jsp        Z›`Ú! KØZ›`Ú! KØ    ¹.  í          4Í>/E¨1‹5C,êFÕ|„^Ñ EditorialsRecord.jsp      ZŒ ÓjúZŒ Ójú    ¹0  í          	TÔÓn¥Œ>ÒÈá OÿÑşğkZ<Ê 
+DIRC      ?ZŒ –aúZŒ –aú    ¹   í          ;I/3ûÓ€(p–`Bš¥m­ˆ5&u` AdminBooks.jsp    ZŒ –aúZŒ –aú    ¹!  í          +p:ÀPlocbu§TYàqû AdminMenu.jsp     ZŒ ÓjúZŒ Ójú    ¹"  í          `!'Èz¯†ˆÌƒEÑÌ í®ª® AdvSearch.jsp     ZŒ ÓjúZŒ Ójú    ¹#  í          xtGg
+Bç†^¬¥¯_à‡ŞÖB• BookDetail.jsp    ZŒ ÓjúZŒ Ójú    ¹$  í          CäS[ãJÄmòÎLÜFñ;ŸD-
+´2 BookMaint.jsp     ZŒ ÓjúZŒ Ójú    ¹%  í          Mé<FCÇAB×ö¨Ñ]¦Ö}Ã¾Ò? 	Books.jsp ZŒ ÓjúZŒ Ójú    ¹&  í          ‘šg¿ç6Dœ+’]“„| 9‰j CardTypesGrid.jsp ZŒ ÓjúZŒ Ójú    ¹'  í          ($t2kşPßÇ¤¾µôZàòı¹Ëè“ CardTypesRecord.jsp       ZŒ ÓjúZŒ Ójú    ¹(  í          "VÆw“°=«ƒ.q)¬ĞZ[ÈM CategoriesGrid.jsp        ZŒ ÓjúZŒ Ójú    ¹)  í          (0î®ÕJ2 ƒ$û¿!Z4fjí‹À: CategoriesRecord.jsp      ZŒ ÓjúZŒ Ójú    ¹*  í          +—K(4üüdŸ`7ªîÏÂªıv²ı¼ 
+Common.jsp        ZŒ ÓjúZŒ Ójú    ¹+  í          {Ñm WŸÚ&å·øë·	|÷‰}‚Q Default.jsp       ZŒ ÓjúZŒ Ójú    ¹,  í          #ä«<vAn¹4 nãqÕ¢I~( EditorialCatGrid.jsp      ZŒ ÓjúZŒ Ójú    ¹-  í          *ÂpmÒêMœÙ!µ2 AÂar¶d EditorialCatRecord.jsp    ZŒ ÓjúZŒ Ójú    ¹.  í          )CºÔó	OùZRÌÑÅ3”K3§v: EditorialsGrid.jsp        ZŒ ÓjúZŒ Ójú    ¹/  í          4Í>/E¨1‹5C,êFÕ|„^Ñ EditorialsRecord.jsp      ZŒ ÓjúZŒ Ójú    ¹0  í          	TÔÓn¥Œ>ÒÈá OÿÑşğkZ<Ê 
 Footer.jsp        ZŒ ÓjúZŒ Ójú    ¹1  í          
 õr˜O+ù÷Sÿ¹‡|BE´  
-Header.jsp        Zšä%–Ù]Zšä%–Ù]    ¹±  í          ¢òl^Ğ<O`Œš6ÇÒ}fòW¸y 	Login.jsp ZŒ ÓjúZŒ Ójú    ¹3  í           j°—^yœœÍnvz¼øÊ,º†=à META-INF/MANIFEST.MF      Z›`Ú! KØZ›`Ú! KØ    ¹/  í          3j3¸%Ã}‘¯»×Æy7ûZ;Ô MembersGrid.jsp   Z›`Ú! KØZ›`Ú! KØ    ¹4  í          FDïehÖ;cØÆ@s:>J¤V›  MembersInfo.jsp   Z›`Ú! KØZ›`Ú! KØ    ¹5  í          R†ğÂ†¿Œ 5h\İdÚÑvwÒ­¢| MembersRecord.jsp Z›`Ú!z]Z›`Ú!z]    ¹6  í          @œV­ùU^ë]Ô
+Header.jsp        Zšä%–Ù]Zšä%–Ù]    ¹±  í          ¢òl^Ğ<O`Œš6ÇÒ}fòW¸y 	Login.jsp ZŒ ÓjúZŒ Ójú    ¹3  í           j°—^yœœÍnvz¼øÊ,º†=à META-INF/MANIFEST.MF      ZŒ ÓjúZŒ Ójú    ¹4  í          3j3¸%Ã}‘¯»×Æy7ûZ;Ô MembersGrid.jsp   ZŒ ÓjúZŒ Ójú    ¹5  í          FDïehÖ;cØÆ@s:>J¤V›  MembersInfo.jsp   ZŒ ÓjúZŒ Ójú    ¹6  í          R†ğÂ†¿Œ 5h\İdÚÑvwÒ­¢| MembersRecord.jsp ZŒ ÓjúZŒ Ójú    ¹7  í          @œV­ùU^ë]Ô
 å!Âõ°å# 
-MyInfo.jsp        Z›`Ú$VÈEZ›`Ú$VÈE    ßê  í          6Š’ú«!½ÏæÏ?Öv·uµ€b> OrdersGrid.jsp    Z›`Ú$VÈEZ›`Ú$VÈE    ¹8  í          6ı?ó"S^"‰Lìmé{ú0ëFæú OrdersRecord.jsp  Z›`Ú$VÈEZ›`Ú$VÈE    ¹<  í          Cş)É‰YŞ;q W{ÀcÖ” Registration.jsp  Z›`Ú$VÈEZ›`Ú$VÈE    ¹*  í          MÏ–p`câsÈ*Wæä×ù¸é“ ShoppingCart.jsp  Z›`Ú$VÈEZ›`Ú$VÈE    ¹9  í          /|43…ì—Ø5Ì&H®)	* ShoppingCartRecord.jsp    ZŒ M|ùZŒ M|ù    ¹=  í          yª†j¨Ü`šĞ(oáÒĞ¿5[mv  database/SQL/BookStore_MySQL.sql  ZŒ M|ùZŒ M|ù    ¹>  í           æI ²B¤z¿_ÏÚîş
+MyInfo.jsp        Z‘~"¸D«Z‘~"{C|    ¹8  í          6Š’ú«!½ÏæÏ?Öv·uµ€b> OrdersGrid.jsp    ZŒ ÓjúZŒ Ójú    ¹9  í          6ı?ó"S^"‰Lìmé{ú0ëFæú OrdersRecord.jsp  Z‘
+®4ı€VZ‘
+®4ı€V    ¹:  í          Cş)É‰YŞ;q W{ÀcÖ” Registration.jsp  ZŒ ÓjúZŒ Ójú    ¹;  í          MÏ–p`câsÈ*Wæä×ù¸é“ ShoppingCart.jsp  ZŒ ÓjúZŒ Ójú    ¹<  í          /|43…ì—Ø5Ì&H®)	* ShoppingCartRecord.jsp    ZŒ M|ùZŒ M|ù    ¹=  í          yª†j¨Ü`šĞ(oáÒĞ¿5[mv  database/SQL/BookStore_MySQL.sql  ZŒ M|ùZŒ M|ù    ¹>  í           æI ²B¤z¿_ÏÚîş
 ãt²û  images/1stars.gif ZŒ M|ùZŒ M|ù    ¹?  í           îøTÇ#Êg#æ<¤iËi|1ñt images/2stars.gif ZŒ M|ùZŒ M|ù    ¹@  í           ôÑšÑauÿhÒ±¡’•—0Öf‰b images/3stars.gif ZŒ M|ùZŒ M|ù    ¹A  í           ğƒ6ÃN4ºR‰Ì)J2*A4è images/4stars.gif ZŒ M|ùZŒ M|ù    ¹B  í           èƒŸR8×ïÇ€¢¥7:^¢¸s•ö> images/5stars.gif ZŒ M|ùZŒ M|ù    ¹C  í          Õ<Ø	nŠ|^êïQù#ûwD ³ images/Logo_bookstore.gif ZŒ M|ùZŒ M|ù    ¹D  í          İ9}¹ŠÁC³ì4¿Tw!Âfª’&Ò images/books/0072122420.jpg       ZŒ M|ùZŒ M|ù    ¹E  í          À¦E*£rØÁŒZ6U‰š¨õJ)8è images/books/020135358X.gif       ZŒ M|ùZŒ M|ù    ¹F  í          ‘#.Ü¬/ïøÍW[^‘ª€bæL images/books/0201354934.jpg       ZŒ M|ùZŒ M|ù    ¹G  í          ­;1©Ü9	îè£Ñ¾ ¥Aª= images/books/0596000278.jpg       ZŒ M|ùZŒ M|ù    ¹H  í          #Ø‚1İ\öâwL»¿b6¶wl3 images/books/0672317842.jpg       ZŒ M|ùZŒ M|ù    ¹I  í          ×k·¾	s¿F*Ë´I%)YûÊP images/books/0672317966.jpg       ZŒ M|ùZŒ M|ù    ¹J  í          \~âóº}•áè„#N­`Câvº‰ images/books/0735609667.jpg       ZŒ M|ùZŒ M|ù    ¹K  í          Ø7êCÈàtJEä¨÷óíÊÔ images/books/0735709211.jpg       ZŒ M|ùZŒ M|ù    ¹L  í          rš;æÇLkŠxd/k_?à”ÀÑ images/books/0735709491.jpg       ZŒ M|ùZŒ M|ù    ¹M  í          ¥ÆóñCr´*SŠÚ¥†°jĞ‘ images/books/0735709971.jpg       ZŒ M|ùZŒ M|ù    ¹N  í          ß´úªás5.iV†ØO”V!Ñ images/books/0761530169.jpg       ZŒ M|ùZŒ M|ù    ¹O  í          aY|¤¨º2˜Bãn‹1İE+p images/books/0782127738.jpg       ZŒ M|ùZŒ M|ù    ¹P  í          Ué¢ÆxÚ²Ÿp$¢İ?\ıb images/books/0789724405.jpg       ZŒ M|ùZŒ M|ù    ¹Q  í          07")ilJ¿´™Å—×/¯ííhºh images/books/0879304979.gif       ZŒ M|ùZŒ M|ù    ¹R  í          ‹Ÿè=Bğ>RmMdÂŸY·ı£9 images/books/1565924347.jpg       ZŒ M|ùZŒ M|ù    ¹S  í          Z2Øÿ†5ÔwÉceK­DU9´Gç{ images/books/1565925157.jpg       ZŒ M|ùZŒ M|ù    ¹T  í          ßÛüîÃyƒ£MY æpk± images/books/1861002726.jpg       ZŒ M|ùZŒ M|ù    ¹U  í           ^‹œ?øO…2¬‘
 MYG images/books/1861003382.jpg       ZŒ M|ùZŒ M|ù    ¹V  í           »q#Fs8³FcÒNB· images/books/1861004656.jpg       ZŒ M|ùZŒ M|ù    ¹W  í          <-Ùƒ[İ€R½k&Ìâ*H images/books/1861004877.jpg       ZŒ M|ùZŒ M|ù    ¹X  í          …jP•ş"]B*ÕäT¸ images/books/1884133193.gif       ZŒ M|ùZŒ M|ù    ¹Y  í          ôğ™È]µº`d=Có_øŒğòr/ images/books/1884777996.jpg       ZŒ M|ùZŒ M|ù    ¹Z  í          	›†p&±v%tåÂ+Q”p­q¾ images/icon_admin.gif     ZŒ M|ùZŒ M|ù    ¹[  í          Ã7P×Â*Õ€áwoá@ØÔckQšƒ images/icon_home.gif      ZŒ M|ùZŒ M|ù    ¹\  í          	…Ãû»³ÍÕ8¯ãßësOiF0btß images/icon_reg.gif       ZŒ M|ùZŒ M|ù    ¹]  í          	{`“é˜½Mµ%V>àŸÚ¨úJ] images/icon_shop.gif      ZŒ M|ùZŒ M|ù    ¹^  í          „ÕhTÅà1‘ Ëó¼Pöx¼
-fx images/icon_sign.gif      p{ŠVÑáD£¦)á®”S¡º
\ No newline at end of file
+fx images/icon_sign.gif      ¼<2–ÑMõ·6\äxÈu¿
\ No newline at end of file
diff -Naur bookstore/MembersGrid.jsp bookstore_secure/MembersGrid.jsp
--- bookstore/MembersGrid.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/MembersGrid.jsp	2018-03-03 20:57:42.814015775 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -309,4 +312,4 @@
   }
   catch (Exception e) { out.println(e.toString()); }
 }
-%>
\ No newline at end of file
+%>
diff -Naur bookstore/MembersInfo.jsp bookstore_secure/MembersInfo.jsp
--- bookstore/MembersInfo.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/MembersInfo.jsp	2018-03-03 20:57:41.714013277 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -446,4 +449,4 @@
   }
   catch (Exception e) { out.println(e.toString()); }
 }
-%>
\ No newline at end of file
+%>
diff -Naur bookstore/MembersRecord.jsp bookstore_secure/MembersRecord.jsp
--- bookstore/MembersRecord.jsp	2018-03-03 20:58:34.553667544 -0600
+++ bookstore_secure/MembersRecord.jsp	2018-03-03 20:57:41.714013277 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -476,4 +479,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
diff -Naur bookstore/MyInfo.jsp bookstore_secure/MyInfo.jsp
--- bookstore/MyInfo.jsp	2018-03-03 20:58:34.561667486 -0600
+++ bookstore_secure/MyInfo.jsp	2018-03-03 20:57:41.718013286 -0600
@@ -9,6 +9,9 @@
 
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(1, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
 
diff -Naur bookstore/OrdersGrid.jsp bookstore_secure/OrdersGrid.jsp
--- bookstore/OrdersGrid.jsp	2018-03-03 20:58:34.609667141 -0600
+++ bookstore_secure/OrdersGrid.jsp	2018-03-03 20:57:41.730013313 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
diff -Naur bookstore/OrdersRecord.jsp bookstore_secure/OrdersRecord.jsp
--- bookstore/OrdersRecord.jsp	2018-03-03 20:58:34.609667141 -0600
+++ bookstore_secure/OrdersRecord.jsp	2018-03-03 20:57:41.730013313 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(2, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -358,4 +361,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
diff -Naur bookstore/Registration.jsp bookstore_secure/Registration.jsp
--- bookstore/Registration.jsp	2018-03-03 20:58:34.609667141 -0600
+++ bookstore_secure/Registration.jsp	2018-03-03 20:57:41.730013313 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 boolean bDebug = false;
 
 String sAction = getParam( request, "FormAction");
diff -Naur bookstore/ShoppingCart.jsp bookstore_secure/ShoppingCart.jsp
--- bookstore/ShoppingCart.jsp	2018-03-03 20:58:34.609667141 -0600
+++ bookstore_secure/ShoppingCart.jsp	2018-03-03 20:57:42.822015793 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(1, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -514,4 +517,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
diff -Naur bookstore/ShoppingCartRecord.jsp bookstore_secure/ShoppingCartRecord.jsp
--- bookstore/ShoppingCartRecord.jsp	2018-03-03 20:58:34.609667141 -0600
+++ bookstore_secure/ShoppingCartRecord.jsp	2018-03-03 20:57:42.822015793 -0600
@@ -9,6 +9,9 @@
               
 %><%
 
+boolean refValid = checkRefererValid(request);
+if (!refValid) return;
+
 String cSec = checkSecurity(1, session, response, request);
 if ("sendRedirect".equals(cSec) ) return;
                 
@@ -320,4 +323,4 @@
 
     }
     catch (Exception e) { out.println(e.toString()); }
-  } %>
\ No newline at end of file
+  } %>
